{-# LANGUAGE MultilineStrings #-}
module Quest_17_input where
import Parser
import Control.Applicative (some, (<|>))
import Data.List (nub, transpose)
import Data.Char
import Data.Either

symbol :: Parser Char Int Char
symbol = oneOf ['.', '*']
sep0 = char '\n'

type Line = [Char]

line :: Parser Char Int Line
line = some symbol

final :: Parser Char Int [Line]
final = sepBy line sep0 <* eof

run part = parse (final >>= (return . part))

-- ================== INPUTS ====================
example1 = """
*...*
..*..
.....
.....
*.*..
"""

example2 = """
.......................................
..*.......*...*.....*...*......**.**...
....*.................*.......*..*..*..
..*.........*.......*...*.....*.....*..
......................*........*...*...
..*.*.....*...*.....*...*........*.....
.......................................
"""

input1 = """
*.........*.........*
.....................
..*......*...*.......
.....................
....*......*....*....
.....................
........*...*........
.....................
*.....*...*...*.....*
.....................
........*...*........
.....................
...*......*...*......
.....................
.....*...*......*....
.....................
*.........*.........*
"""

input2 = """
*......................*.................*..*.......................................................*
...*..................**......................................*......................*....*....*.....
.*..*..*.................................*....*..................*...................................
.......................*..................................*........................................*.
..............................*...............................*.........*.................*..*.....**
..*.................................................................*..........*.....................
.....................*...........*..................................................................*
............*........................................................*......*........................
.*................................................................................*..................
....*................................................................................................
.....*................................*........*.................*...*....*.........................*
..............*..........................*..*.....................................................*..
......................................*.................*..*................*...................*....
.....*....................*...*.......*...................................*..*...............*.......
...................**................*........................*..*.....*.............................
.........*.....................*......*....*........*...........................................*....
............*........................................................................................
..........................*..*..*....................................................................
..............*..............................*........*....*.........................................
...........*.............*...........*.........................*.........................*....*......
.......................*.................*........................*..................................
..............................*.......*...............................................*..............
............*................................................................*.............*.........
.......................................*...*..............*.............*.................*.....*....
....*.............**..............*...............*................*.................................
...*....*.....................................*..***..........................*........*...........*.
......*.........*.......*...........*...........*.*.................*................................
...............................*.................................................*...................
..............................................................................................*......
....................*...........*........*..............................*............................
..........................*...........................*.....*...*......................*......*......
..*.*.................*..*.............*............**.*.................................*...........
.........................................................................*...*.......................
......*...............................**........*.....................*..............................
.....*...........................**...........................*......................................
................................*........**..........................*.........*.....................
.*..................*...........**.*..*....................................................*......*..
...........................*....*...*...........................................*.*...............*..
........*..............................*..*.....*...........................................*........
..............................................*.........*...........................*.....*..........
..................................................*...............................................*..
........*.....*....................*.............................*.......*...........................
..............*.............................*...........*..............*..........*...*..............
.............................*.............*.............*...............................*...........
*.................*................*..............*..........*.............................*.........
.........*..........*............................*........*....**.......*............................
....................................*...........................*...........................*........
.............................................*......*..*.............*..................*.....*......
..*.........................*..*....*................................................................
.*.....................................*.........................*...*..*..*.*.........*...........**
*.*.................................................................*......*........*..*...........**
"""

input3 = """
*....*...............*.....*...................................................................*......................................................*..................*..............................*
..............................*............................*..*..................................................................*.....*...................................................*.............
............*............*..*........................*........*.............*.......*.*.............................*.........*................*.....*...................................................
......*....*...........*.....*....*..................*.*...........................................*...........*.............*..............*..............................*......*...*................*.
.....*........*.....*....................................*.......................*..................................*..............*..............*.................*...............*........*...........
.........*.....*........*.....*........................*.................*......................*........*.........**...................*.................................*..............................
......*.............................................................*........................*..*........................*...............................*..........................*.....*..*...........
.....................................*.*................*.*.......................*..................*...........................................................*...................................*...
..................................*......................*.....*...*.....................*......................*.......*................................................................................
**.......*................*.........*..............................*.......................*..............*............*........*........*....*...........*...*..........................................
......................*.......*........*................................................................................................*...................*...*...*..................*.................
....................*.........**......*.*......*...................*.....................................*...........................*...................*........*.......*.............*................
...................................*....................................................*...*...*......................*...................................*...................*...*......*.....**.......
............................*......**......*.*........*..*.................................................................................................*........*.......*...........*.........*..**..
........*...........*...............*.....................*............*.................*............*.......................................*.................*...........................*..........*.
......*......*..........*.*.......*........*.*...*...*................*...*.......................*............*..*..........**.............*.......*........*........*.......*...............*.*........
...*..........................................*........*.......................*..............*......................................*.............*..........................................*.....*....
...................*.....*....*.*....*...*.....................*....................*.......................................................*...............*..*........**.....*.........................
.......................................................*...................*..........................*..........*.......................................................................................
...*...................*.......*.......*..................*....*.....*.............*.............*......*........................*.........*.................*...*......**.......*..................*...*
..........*...........................................*...............................................................................*.........*...............*........................................
*.............*.*.....*......*....*..*....................*............*.*...........**.......................*...................*.........................*......*.......*......*....................*.
....................................*.......................*.....................*..............*..*..*.........*..............................................*...*....................................
....*...............*.......*......*...*.......................................................*....*...............*................................................*......*.......*..***...............
..*....................*....................**..........................*...*................................................................................................*........*...........**..*..
...................*......*..*....*.......*.........*...........................*.......................*....*.........*...*..........................................*.......*......*......*.......*....
......................*............*...........*...*...................*....................................................*............................................................................
......*...........*..*...*......*..............*................*..................*..................*...*.................................*..........*................*...*..*......*...*......*.......
.....*....*............*.......................................*.....................**..............*......................*...........................................................................*
........**.......*...**.*..*...*......**..............*.....................*..*........*.*................*....*...*...........*.*.....................*...........*....*......*......*..............*.*
.......*........*..........................................*..*....*..............*...............................*...*..........................*.....................................*.................
..*.............**....**......*...........*..............................*.*.............................................................*................................*...*..*......*....*.*.....*...
.......*.........*..............................................*..................*...................*..................*...........................................................*...............*..
...*........*..*......*.....*..............*.......*.................*.....*.*...............*......*...*..*.............................*..................................*.....*......*...........*...
................*...**.............*...................................................*................................*............*.........................*.............*.......*.......*........*..
..........*...*.....*......*.*............................................................................................................................*...*..............*......*.....*..............
.........*................*...*.....***......*......................*........*.*..*......................................*...............................*.*........................*....................
.............*......*.....*.......*.*..........................................*.........*....*.....*...*...................................*......................*.*........*.....*......*.............
..*................................................................*..........*.......................*.............*..............*.....*......................................................*..*...*.
............*......*.....**.................................*...............................................*..........................*............*...........*...*..........*.....*......*............
*...........*................*.................................................*....................**..................................................*...*...........*........*.......................
...........*......*.....*...*...........................................................*.........................................................*...........*.................*.....*......*...........
...*...................................*.....*....*..........*.....*..........*......*...*....................................................................*..........*.*.............................
...........*.....*.....*.....*.......................................*..............*.......................................*..........*...*.................................*...*.*...*.....*.......*...
..............................................................*...................*.......*............................................*.................................................................
..........*.....*..*...*.*........*..................*.................................................*.*.......*......................*......................................*.*......*.....*..........
.......*..*...................................*......*...........*........*..................................................*..........................................................*..*.............
.........**.*...*.....*............................................*.......*............................................*..........**..**.....................................*...*.....*......*.........
................................*...............*........................*...*................**.................*..................................*.......*........................*..........*..*.....
.......*.*.....*.....*.....*.......................*..............................*......................*............*......................*.....................................*.....*.....*.........
.......................*..................................*.......................................*.........*....................*...........*...........................................................
........*.....*......*......................................................*...................................*.............*...**...............................................*......*.....*........
.*..........................*.............................*.............................*........................................*......*................................*........*...*..................
.*......*.....*.....*......................................................................*............*............*..............*.*........................................*....**....*.....*.*.*..*.
...........*....................................................................................**.*.........................................................................................*...........
.......**.*..*.....*.................................................................................*.........................................*..................................*..*.....*.....*.......
........*.............................*.......**....*.............*...........**......................*.*..........................................*..*....*..............*...........*....*.............
.......*.....*..*..*.....................*.......................*..............*..........*............................*...........................................................***....*.....**......
.................*.*.*..............................................................*.....*...................................................**........*....*......................*....*.......*.......
.....**.....*......*..............................*..*......*.......*............................*............*.......................*....*.........................................*......*..*.**......
..........*.......................*..................................*............................*...........................*...*......................*..*...*....**..................................
.*....*.....*.....*.............*.............*.....................*.................*.............*..*...........*.*................*........................................*..*...*.....*.....*......
..........*.....*...*......*.......*..........................................................*...............**........*......................*.........*......................*........................
......*.....*.....*...*.........*...............*......*..................................*........*.................................................*.............................*..*.....*.....**....*
....*.......*..................*...............*................................................*.....*......................*........*.................**........*..........*........*..................
......*.*...*.....*..................*.*...*.......*.......................................*................................*......................................**.................*.*...*.....*......
*..*...........*...........................*....*.......................................*..........*.*.*.*.*.*.*.*.*.....................*......................................*........................
.....*.....*....**...........................*.................................................*.*.*.*.*.*.*.*.*.*.*.*...........*.....................*...............................**....*.*...**.*..
.....................*.......................................................................*.*.*.*.*.*.*.*.*.*.*.*.*.*.*....*................*.......................*..*.*............................
.....*.....*.....*........................*.............................*....*..............*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*....*..............*.......*..............................*.*....**.*...*.....
*...*........................*..................*..........................................*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*........................*.........*..........*..........................*....
.....*.....*.....*....................................................*.........................*.*.*.*.*.*.*.*..**...*.*.*.*...*.......................*..............................*.....*.....*.....
.............*...............................................................*.*.*.*.*...........*.*.*.*.*.*.*....*....*.*.*.*..................*.........*..........*............................*......
.....*.*...*.....*....*.....*.................................................*.*.*.*.*.*.*.*.....*.*.*.*.*.*...........*.*.*.*.....................*........*.........................*.....*.....**....
.......................*.......*.................................*...............*.*.*.*.*.*.*.....*.*.*.*.*.*.........*.*.*.*...................................................................*.......
.....*.....*.........................*......................*.........*.................*.*.*.*.*...*.*.*.*.*.*.*...*.*.*.*.*.*..........................*....*..............*.**............**...**.....
........*.................*........................................................................*.*.*.*.*.*.*.*.*.*.*.*.*.*..................................*........................................
*....*.....*...*.*.......*...............*..............................*..........*.*.*.*.*.*......*.*.*.*.*.*.*.*.*.*.*.*.*.*.............**....................................*....*.....*....**...*.
...*..................................................................................*.*.*.*.*......*.*.*.*.*.*.*.*.*.*.*.*.*.........*.................*.........................................*.....
.....*.....*.....*........*............................................*....*.........................*.*.*.*.*.*.*.*.*.*.*.*.*....................................*.................*.*.....*.....*.....
.............................*....*.................*........................................*.........*.*.*.*.*.*.*.*.*.*.*.*............................*.....................*........................
.....*..*..*.....*..*...........*....................................................*...........*........*.*.*.*.*.*.*.*.*.*...........................*..............................*.....*.....*.*...
..*.................*................................................*....*...........*......................*.*.*.*.*.*.*.*..........................................................*.....*............
.....*.....*.....*................*.......................*..*.......................*............................*.*.*.*.*..........*.................*...............................*.....*....**.....
............................*...........................**..............*...........*..............*..........*.........*....*....*.................................*....................................
......*.....*.....*........................................*........*..................*......*................*....*..................................*...........................*..*.....*.*...*......
....*.*....*......................................**.............................................*.....................*.......................*...................*..*.............................*....
......*.....*.....*..............................................................................*..*...........*.................................................*........*..........**....*.....*......
...............*............*..........*.............*.*........*.....*.*.........*..............*...*...............*.*...........*........*...........................*...............................*
......*.....*.....*..........................................*.........*.....*......*....................................................*................*........*.................**.....*.....*......
.............................*.................*...*..................................................................*....................*.**.........**.*..................*.....................*....
......*.....*......*................*............*..................*..................*..........................*.*....**..........................................*.........*.....*......*.....*......
...................*.....*..........*...............................*.*..*.......*.............................*................................**...*...............**.*................................
.......*...*.*...*.*.....*...............................*.........................................*....*..............................................*.............................*.....*.....*....*..
...............................................*...............*................*........................*........*..........*...*.....*.................................*...............................
...*...*....**.....*...............................*.**...................................*...........................................*.......*.................*....................*.....*.....*.......
....*.....*.....................*............*.........................*..........*...*......................*............*..*.....................*...........*..............*........................*.
........*.....*..*..*...............*........................*......*..............*..............*.*...*..........*.................................*.................*............*.*...*.....*........
..............................*....*...*.................................*........*..........*............*.................*..*.....................**..................................................
...*....*.....*...*..*..................................*..................*.....................................*........................................................*........*......*.....*........
.............................................................*.....*.........................*..*...............................................................................................*.....*..
......**.*.....*.....*..................................*.....................................*............*............................*.................................*........*..*..*.....*.......*.
.....................*...........................*.........*...*.......................................................*....................*.........................*..........*...............*.......
.........*......*.....*....................................*.*....*..............................*.......................*..*.....................................................*....**......*.........
......................................................*.*......*.....*.......................*.............*...*........*........*..*.........*.....................*..*.....*.*.........................
....*.....*.....*......*....*........*......................*.........*....*...........*....*.*................*.......*............................*....*....*........*.....*...*......*.....*..........
..............................................................*..........*.............*....*.............................................................*.........*....................................
...........*.....*.....*.*.................................*...........*.......*...............*.............*.............*..............*..............*..........*............*.....*..*..*...........
...........................................*........................*.......*......................................*.................**..............*.............*.......*.....*.......................
...........*......*..*..*...................*..............*...................................*................*...............*.......*........*...............*....*.........*.....*......*.**....*...
....*..........................................................................................................*.............*...................................*............................*..........
............*......*.....*...*...............................*..............*.......*.............*.......*.........................................*..............*...........*.....*......*............
................................*..............*.........................*............**.......................*.....*..............................................*....*....................*..........
....*....*...*......*.*...*..................*.....................................................................................*...............................*....*.....*.....*......**............
.....*..............*....................*...........*....................................*...*......................*..*..*.........*.*...................*.................*...*.*.....................
.............**.....*......*......*....*...........*......**..........................................*..........................*...........*.**.........*..*...............*.*....*.....*..............
..............................................................*......................*.....................*...........................................................................*..........*......
..*............**.....*.*...*...................*...................................................*.........................................*..*.....................*....*.....*......*.............*.
.......................*..................*........*............*................................................**..........*..................*............................*........*..................
................*......*......*.......**...........................*................*..*.........*.....................*.....................*........................*..**......*......*.........*......
.....*......*.....*....*.................*..*...........................*..................*......................*.*.............................*........*..................*.............*............
.................*.*....*......*........................*......................................*.*...................................................*........*.....**...*.....**......*...............*.
..........*.....................................................*..............................*.......................................*........................*........*...*...........................
..................*...*..*....*.*.*.........*.........................*.......*.............................*....*..........*................*...*..........*...........*.*....*..*...*...**.............
..............*.....................................*......................................*.......*....................*..*......*...............................*......................................
..................**..*...*.......*........*...................................*.................*..*...............................................*.................**.*....*......*...................
....................*..................*...*..........*..*.............*....*..............*........*.....*..................*...*...........*....***...*................*........*...........*.*......*.
....................*.......*.*....**.........................................................*.......*......*........................*..............................**.....*..*....*...*................
....*.................*..........*.....*..................................*..............*................*...........................*....*......................**.....................................
...........*....*.....*......**......*...........*.......*..*........*..............*..............................................................................*...*...*......*........*.............
.*....*...................*...............................................................*........*...............................*.................*...........*.............*.........................
.....**................*......**.......*........................................*...*.........................*.*................................................*.......*...*...*...........*..........*
...................*......................................................................**......*.......................................................................*..........*...................
....*......*.............*.....**........*.*..................*.......**...............*.............................*.*.....................*.................*........*......*.........................
............................................*............*.........*......................*....*...................................................*.......................*.............................
..................*.......*.......*........*.............................................*...............*..............*....................................*........*.......*..........................
....**.............*....*...*...........*...*....................................................*........*..........*..........................**...................................................*...
..................*.........*.......*........*..........................*.....*.......................**............................................**.....*........*.......*..........................*.
....................*......*................*.*..........................*...........................*......*...............*................*...........*.......*.......................................
.........*....................*.......*........*......*....................*..........................................................*..................**.......*.......*.......*......................
.............................*.......................*............*......................................*.........*.......................................................................*........*....
.*......................*....................................*........**.....*...............*.........*.*......................................*............*.......*..*...................*............
..........*...............*.......................................................................*............................................................*.*.*.....................*..*............
............*......*...................................................................*............*...........*........................*..................*....*..**..............*....................
.............**..................................................*...........................................*............*...................................*..............*.*.........*.........*.*...
............*...............................*.*.................*........................................................*.......*......*..........*....................................*......*.......**
............*........*......*...*..*................*.*..........................****..............................................*............................................*........................
......................*.........................................................................................................................................*...*....................................
............*...............*..........*.....................*................*..........................**.*..........*............*.............................*............*...*...............*.....
.................*.........*........*......................................*......*............*.............................*................................*........................................**
*...........*...................................................................*.................................*.....*..............................................................................**
"""
