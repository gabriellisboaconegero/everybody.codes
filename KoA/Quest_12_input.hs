module Quest_12_input where
import Parser
import Control.Applicative (some, (<|>))
import Data.List (nub)
import Data.Char
import Data.Either

symbol = oneOf (['A'..'Z'] ++ ['.'])
sep0 = char '|'
sep1 = char ';'

type Term = String

term :: Parser Char Integer Term
term = symbol *> symbol <:> some symbol

final :: Parser Char Integer [Term]
final =
  let
    expr = sepEndBy term sep0 <* some (char '=') <* eof
  in (filter $ any (/= '.')) <$> expr

final2 :: Parser Char Integer [(Integer, Integer)]
final2 = sepBy (natInt <* sep1 <~> natInt) sep0
  where
    natInt = read <$> natural

run part = parse (final >>= (return . part))
run2 part = parse (final2 >>= (return . part))

-- ================== INPUTS ====================
example1 = ".............|.C...........|.B......T....|.A......T.T..|============="
example2 = ".............|.C...........|.B......H....|.A......T.H..|============="
example3 = "6;5|6;7|10;5"

input1 = ".................................|.C............T..T.........T.T.T.|.B............T..T.........T.T.T.|.A............T..T.........T.T.T.|================================="

input2 = "...................................................................................................|...............................................................................TT..TT..TTT..TT..TT.|...............................................................................TT..TT..TTT..TT..TT.|..............................................................................TTTTTTTTTTTTTTTTTTTTT|...............................................................................TTTTTTTTTTTTTTTTHTT.|...............................................................................TTTTTTTTT.TTTTTTHTT.|...............................................................................TT.TTTTT...TTTTTTTT.|...............................................................................TTHTTTTT...TTTTT.TT.|..............................................................................TTTTTTTTTTTTTTTTTTTTT|...............................................................................TTT.HHHHHTHT.HHTTTT.|...............................................................................TTHH.THHTTH.T.TT.TT.|...............................................................................TTHTHTT.H.TH...HHTT.|...............................................................................TT.HH...HTHHHHTTTTT.|...............................................................................TTH..T..HT..TH.H.TT.|...............................................................................TTTHTTHTTTTT.HTT.TT.|...............................................................................TTTTTHT.THTHHTHT.TT.|..............................................................................TTTTTTTTTTTTTTTTTTTTT|.C.............................................................................TT.TTTTT...TTTTTTTT.|.B.............................................................................TTTTTTT.....TTTTHTT.|.A.............................................................................TTTTTTT.....TTTTTTT.|==================================================================================================="

input3 = "3845;2914|3777;2809|3760;2910|3730;2531|3802;2991|3890;2630|3924;3048|3987;3006|7200;3601|3936;2800|3763;2859|3983;2969|3994;2928|3935;3184|3706;2979|3561;3115|3637;2526|3991;3015|3630;3063|3844;2702|3787;2803|3758;3096|10;10|3570;2608|3539;2567|3533;2837|3650;3228|3534;3018|3925;3413|3710;3235|3961;2618|3634;2631|3956;2587|3978;2879|3862;2946|3886;2976|3976;1989|3826;3046|3569;3338|3530;2753|3647;3444|3947;3363|3888;2953|3527;3158|3568;3019|3852;2856|3800;3102|3808;3025|3828;2543|3705;2757|3576;3388|3801;2638|3583;2660|3674;2864|3575;3118|3613;3145|3636;2525|3518;3299|3867;3064|3849;2643|3700;3702|3537;2539|3524;3426|3803;2768|3687;2818|3544;2577|3793;2866|3727;3310|3700;2535|3540;2750|3563;3393|3631;2570|3554;3244|3506;3461|3517;2601|3827;2583|3716;3391|3986;2795|3772;3199|3966;3414|3863;3448|3556;2929|3614;3241|3807;2558|3573;2889|3504;2881|3881;2904|3600;2949|3817;3303|3951;2810|3909;3353|3894;3042|3618;3209|3722;3335|3700;3701|3619;2913|3939;2771|3555;3068|3969;2590|3883;2609|3952;3294|3955;2885|3704;3076|3865;3293|3856;2509|3819;2668|3683;3226|3669;2537|3806;2506|3837;2581|3874;3357|3519;3372|3526;3181|3655;3052|3652;2754|3515;3214|3780;2624|3840;3313|3604;3378|3726;3056|3762;2983|3921;2507|3820;2546|3847;3253|3719;2637|3767;2599|3623;2633|3811;2922|3661;2769|3761;2588|3988;3361|3523;3352|3750;2880|3685;2628|3836;2808|3691;2919|3838;2639|3812;3124|3992;3243|3971;3290|3712;2804|3815;2606|3558;2816|3757;3112|3751;2717|3776;3494|3949;2811|3649;2988|3768;2978|3701;2625|3564;2685|3572;2850|3892;3490|3663;3423|3858;2776|3790;2693|3667;3399|3595;2600|3923;2865|3941;2569|3942;2923|3920;3425|3905;3030|3502;2707|3541;2678|3973;3340|3834;2785|3997;3298|3577;3205|3769;2565|3651;3132|3995;2993|3857;2901|3591;2658|3985;2960|3981;2887|3748;2843|3904;3032|3548;3022|3658;2571|3675;3157|3714;2532|3979;3207|3590;2655|3972;3496|3785;3394|3860;3035|3805;3083|3833;3447|3532;3100|3848;3221|3915;3252|3752;3138|3562;2872|3778;2741|3948;3139|3968;3239|3743;3380|3742;2650|3738;2593|3565;2957|3728;3163|3725;3074|3913;2705|3998;3346|3896;3101|3584;3410|3754;3347|3672;3258|3900;3010|3542;2530|3702;3322|3889;2925|3753;3180|3513;2586|3872;2620|3977;2533|3689;3238|3899;2698|3645;2926|3509;2725|3918;2541|3964;3126|3912;3167|3832;2566|3854;2920|3879;3125|3551;3217|3605;3155|3622;2854|3664;2943|3592;3325|3945;2651|3782;2821|3901;3213|3677;2845|3775;2992|3877;3283|3906;3454|3859;2534|3521;2556|3626;2734|3931;3489|7202;3602|3839;3424|3958;3097|3520;2968|3897;2653|3522;2514|3684;2721|3765;3162|3744;2997|3721;2704|3505;3456|3696;3287|3665;2841|3550;3229|3653;3130|3929;2735|3511;3333|3835;3119|3690;2528|3596;3270|3641;3392|3501;3312|3587;3210|3698;3047|3588;3168|3963;3136|3749;3105|3853;2670|3703;2691|3917;3218|3535;3027|3512;3268|3976;2972|3965;2774|3682;3339|3916;2617|3850;3351|3536;2545|3723;2652|3639;2758|3602;3452|3974;3023|3581;3308|3937;3007|3908;3202|3582;3362|3711;2722|3783;2733|3944;3455|3759;2892|3989;3467|3796;2842|3804;2831|3734;3466|3560;2964|3585;3110|3907;3404|3729;3208|3594;3024|3911;3001|3597;3223|3516;2767|3871;3269|3735;2642|3514;3116|3648;3131|3662;2907|3608;2682|3770;2677|3629;3085|3898;2689|3720;2802|3919;3156|3855;3053|3678;3212|3673;2521|3814;3123|3822;3277|3707;3445|3940;3203|3546;3488|3984;2933|3868;2574|3545;2579|3851;3482|3943;3249|3825;2505|3960;2712|3982;3330|3692;3343|3885;2867|3946;3169|3635;2823|3755;2766|3632;2626|3503;2665|3578;3406|3779;2779|3731;2863|3525;3187|3861;2770|3891;2958|3660;3480|3606;2951|3876;3438|3580;3146|3713;3332|3715;3164|3882;3251|3792;3376|3970;3474|3884;3348|3612;2679|3893;2825|3959;3242|3656;2791|3781;3356|3914;3320|3736;2876|3679;3170|3566;2549|3646;3273|3670;2759|3740;3459|3586;3147|3926;2998|3531;3237|3756;3324|3528;2959|3813;2647|3724;3037|3774;3087|3616;3304|3603;2572|7198;3600|3934;2798|3671;3128|3628;3072|3797;2896|3601;2847|3902;2748|3717;3271|3810;2529|3599;3289|3873;2916|3799;3479|3741;3398|3798;3386|3579;2666|3694;3485|3666;3260|3620;2760|3870;2568|3831;3012|3990;2898|3746;2762|3552;3409|3784;3172|3928;3321|4000;2645|3557;2763|3733;2975|3624;2772|3927;2773|3903;3004|3824;3121|3864;3174|3953;3113|3818;2806|3843;3282|3688;3065|3695;3396|3589;3498|3930;2584|3718;3233|3559;3337|3967;2656|3693;2683|3789;3153|3676;2667|3610;2716|3932;3104|3507;3045|3640;2671|3999;2674|3538;3477|3627;3422|3875;3256|3747;2513|3980;2999|3880;3275|3700;3700|3686;3373|3643;3381|3962;2967|3508;3344|3878;3450|3529;3175|3823;2512|3644;3034|3681;3408|3933;3141|3598;3377|3887;3038|3567;2732|3922;3462|3950;3397|3697;2749|3625;2956|3841;2789|3668;3417|3659;2585|3830;2961|3732;3295|3809;3436|3621;2502|3680;2888|3745;2519|3549;2882|3510;2897|3786;2621|3611;3487|3657;3285|3739;3231|3938;2726|3996;3491|3829;2696|3709;3402|3821;2559|3708;2664|3957;2576|3699;3291|3737;3071|3593;2846|3654;2715|3866;2619|3543;2524|3633;3265|3910;3430|3773;2636|3642;2985|3574;2986|3993;3318|3764;2827|3553;3470|3609;2515|3842;3431|3615;2990|3791;3307|3638;3060|3954;2635|3607;3481|3846;2994|3975;2663|3771;2736|3794;3200|3766;2605|3547;2981|3795;2708"
