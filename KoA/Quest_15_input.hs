module Quest_15_input where
import Parser
import Control.Applicative (some, (<|>))
import Data.List (nub)
import Data.Char
import Data.Either

symbol = oneOf (['A'..'Z'] ++ ['#', '.', '~'])
sep0 = char '|'

type Term = String

term :: Parser Char Integer Term
term = some symbol

final :: Parser Char Integer [Term]
final = sepBy term sep0 <* eof

run part = parse (final >>= (return . part))

-- ================== INPUTS ====================
example1 = "#####.#####|#.........#|#.######.##|#.........#|###.#.#####|#H.......H#|###########"
example2 = "##########.##########|#...................#|#.###.##.###.##.#.#.#|#..A#.#..~~~....#A#.#|#.#...#.~~~~~...#.#.#|#.#.#.#.~~~~~.#.#.#.#|#...#.#.B~~~B.#.#...#|#...#....BBB..#....##|#C............#....C#|#####################"

input1 = "#####################.#####################|#.........................................#|###########.#####.###########.#.###########|#.........................................#|###.#####.##########################.#.####|#.........................................#|#############.######.#####.####.###########|#.........................................#|##.###.#############################.#.####|#.........................................#|###############.####.#.#####.##############|#.........................................#|#.#######################################.#|#.#.#...#.#.#.................#.#.#.#.#.#.#|#...#.#.#...#.................#...#...#.#.#|#.#.#...#.#.#.................#.#.#.#.#...#|#...#.#.#.#.#....###...###....#.#.#.#.#...#|#.#.#.#.#...#...#####.#####...#...#.#.#.#.#|#.#.#.#.#.#.#...#####.#####...#.#.#...#.#.#|#.#.#.#...#......###...###....#.#.#.#.#.#.#|#.#.#.#.#.#.......#.....#.......#...#.#.#.#|#.#.#.#...#.#.....#.....#.....#.#.#.#.#.#.#|#.#...#.#.#.#.................#.#.#.#...#.#|#.#.#.#.#.#.#...H.H.H.H.H.H...#.#...#...#.#|#.#...#.#.#.#...................#.#.#.#.#.#|###########################################"

input2 = "##########################################.##########################################|#.A.#.#.#.#.#.#.#.#.....#.#.#...#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.....#...#.#.#.A.#|#.A.#...#.#...#...#.#.#.#...#.#.....#.#.#.#.#...#.#.#.#.....#.#.....#.#.#.#...#.#.A.#|#.A...#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.....#.#...#.#.#.#.....#.#.#.#.#.#.#.#...A.#|#.A.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#...#.A.#|#.A.#.#.#.#.#.#.#.....#.#.#.....#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.A.#|#.A.#.#.#.....#.#.#.#.#.#...#.#.#.#...#...#.#...#.#.#.#...#.#.#.#.#.......#.#.#.#.A.#|#.A.#.#.#.#.#.#.#.#.#...#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...A.#|#.A.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#...#...#.#.#.#.#.....#.A.#|#.A...#...#.#.#...#.#.#.#.#...#.#.#.#...#...#.#...#...#.#...#.#.#...#.#.#.#.#.#.#.A.#|#.A.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.A.#|#.A.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.A.#|#.A.#...#.#.#.#.#...#.#...#.#.#...#.#.#.#.#.#.#.#...#...#.#.#.#...#.#...#.#.#...#.A.#|#.A.#.#.#.#...#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.A.#|#.A.#.#.#.#.#.....#.....#.#...#.#.#.#.....#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.A.#|#.A.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.#.#...A.#|#.A.....#...#.#.#...#.#...#.#.#.#.#...#.#...#.....#.....#.#.#.#.#.#.#.#.......#.#.A.#|#################.#################################################.#################|#...#.#.#.......#.#.#.#.#.#.#.#.#.B.B.B.B.B.B.B.B.B.#.#.#...#.#.#...#.#.#...#.#.#...#|#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.B.B...............B.B.#.#.#...#.#.#.#...#.#.#.#.#.#.#|#.#.#.#.#.#.#.#.#.#.....#...#.B.B.....~~~~~~~~~.....B.B.#.#.#.#.#.#.#.#.#.#...#.#.#.#|#.#.#.#.#.#.#.#.#.#.#.#...#.#.B....~~~~~~~~~~~~~~~....B.#.#.#.#...#...#.#.#.#.#...#.#|#.#.#.#.#.#.#.#.#.#.#.#.#.#.B.B...~~~~~~~~~~~~~~~~~...B.B.#.#.#.#.#.#.#.#.#.#...#.#.#|#.#.#.#...#.#.#...#.#.#.#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.#.#.#.#.#.#.#.#.#.#.#.#.#.#|#.#.#.#.#.#.#.#.#.#.#.#.#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.#.#...#.#.#.#...#...#.#.#.#|#.#.....#.#.#.#.#...#...#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.#.#.#.#.#.#.#.#.#.#.#...#.#|#.#.#.#.#.#...#.#.#.#.#.#...B.B...~~~~~~~~~~~~~~~~~...B.B...#.#.#.#.#...#.#.#.#.#.#.#|#.#.#.#.#...#.#.#.#.#.#.#.#.#.B....~~~~~~~~~~~~~~~....B.#.#.#.#.#.#...#.#...#.#.#.#.#|#.#.#.#.#.#.#...#.#.#.#.#.#.#.B.B.....~~~~~~~~~.....B.B.#.#.#.#.#...#.#.#.#.#.#.#.#.#|#.#.#...#.#.#.#.......#.#.#.#.#.B.B.B...........B.B.B.#.#.#.#.#...#.#.#.#.#.#...#.#.#|#.#...#...#.#.#.#.#.#.#...#.#.#.#.#.B.B.B.B.B.B.B.#.#.#.#.#.....#.#.#.#...#.#.#.#.#.#|#.####################################.#.#.#.#.####################################.#|#.C.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#..#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.C.#|#.C.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...........#.#.#.#.#.....#.#...#.#.#.#.#.#.#.C.#|#.C.#.#.#.#...#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.C.#|#.C.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.C.#|#.C.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#...#...#.#.#.....#.#.#.#.#.#.#...#.#.#.#.#.C.#|#.C.#.#.#.#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.C.#|#.C.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.C.#|#.C...#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.#.#...#.#.C.#|#.C.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...C.#|#.C.#...#...#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#.#.C.#|#.C.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.C.#|#.C.#.#.#.#.#...#.#...#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#.C.#|#.C.#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.C.#|#.C.#...#.#.#.#.#...#.#.#...#.#.#.#...#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.C.#|#.C.#.#...#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#...#.#.#.#.#.#.C.#|#.C...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...........#...#.#.#.#...#.#.#.#...#.#.#.#...C.#|#.####################################.#.#.#.#.####################################.#|#...#...#.#.....#...#.#...#.#.#...#.............#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#...#|#.#...#...#.#.#...#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#|#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.....#.#...#.#...#...#.#.#.....#.#...#.#|#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.....#.#.#...#.#.#|#.#.#.#.#.#.#.#.#.#...#.#.#.#...#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#|#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...#...#...#.#.#.#.#.#.#.#.#|#.#.#.#.#.#...#.#...#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#|#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#|#.#...#.#.#.#.#.#.#.#...#...#.#...#.#.#.#.#.#.#.#.#...#...#.#.#...#.#.#...#.#.#.#.#.#|#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#|#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#|#.#.#.#.#.#.#.#...#.#.#.#.#.#...#...#.#...#...#.#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#|#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.....#.#.#.#|#######################.#####################################.#######################|#.....#.#.#.#.#.#.#.#.#.#.#...#.#.#...............#.#.#.#.#.#.#.#.#.#.#...#.#.#.#...#|#.#.#.#.#.#...#.#.#.#...#.#.#.#.#........###......#...#.#.#.#.#...#.#...#.#.#.#.#.#.#|#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#....#######....#.#.#.#.#.#.#.#...#.#.#.....#...#.#|#.#.#...#.#.#.#.#.#.#.#.#...#.#...#...#########...#.#...#.#.#...#.#...#.#.#.#...#.#.#|#.#.#.#.#.#.#.#...#...#.#.#.#...#.#...#########...#.#.#.......#.#.#.#.#...#.#.#.#.#.#|#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#....#######....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#|#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#......###........#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#|#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.........#.......#...#.#.#.#.#.#.#...#.#.#.#.#...#.#|#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.......#.......#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#|#.#.#.#.#.#.#.#.#.#...#.....#.#.#.#.......#.......#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#|#.#.#.#.....#.#...#.#.#.#.#.#.#.#.#...............#.#.#...#.....#...#.#.#...#.#.#.#.#|#.#.#.#.#.#.#...#...#...#.#.#.#.#.#.......D.......#.#...#...#.#.#.#.#.#.#.#.....#.#.#|#E#...#.#.#...#.#.#.#.#.#.#.#...#.#.................#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#E#|#####################################################################################"
